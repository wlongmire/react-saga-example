ehr_web:
  build:
    context: .
    dockerfile: Dockerfile
    args:
      - CI_BRANCH=$CI_BRANCH
  volumes:
    - .:/usr/src/app
  environment:
    - REACT_APP_API_HOST=api.life.${CI_BRANCH}
    - REACT_APP_API_PORT=443
    - REACT_APP_API_TOKEN=d99e7ff5-d9f2-48ba-83de-ba4bd8a4ab5a
    - REACT_APP_ENV_NAME=${CI_BRANCH}
    - CI_BRANCH

ecs_cheap:
  image: codeship/aws-deployment
  encrypted_env_file: aws-deployment.env.encrypted
  environment:
    - AWS_DEFAULT_REGION=us-east-1
  volumes_from:
    - ehr_web

ecs_guitars:
  image: codeship/aws-deployment
  encrypted_env_file: aws-deployment.env.encrypted
  environment:
    - AWS_DEFAULT_REGION=us-east-2
  volumes_from:
    - ehr_web

ecs_co:
  image: codeship/aws-deployment
  encrypted_env_file: aws-deployment.env.prod.encrypted
  environment:
    - AWS_DEFAULT_REGION=us-east-1
  volumes_from:
    - ehr_web
